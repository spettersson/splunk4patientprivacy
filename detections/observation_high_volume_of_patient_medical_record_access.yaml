name: High Volume of Unique Patient Medical Record Access
type: Observation Triggering
description: This detections looks for staff members that access a high volume of distinct patient medical journals in 
          a short time period compared to their peers. For each match, an observation is created and stored as an event in 
          index=observation.
detection_ID: obs6
author: Simon Pettersson, Splunk
prerequisites:
- data sources:
          EHR audit events from any source
- tags: 
          auditevent (=identifies all EHR audit logs, regardless of source system)
- indexes: 
          observation_collection (=where identified observations are stored as individual events)
- fields: 
 	action (type of action performed during the event - e.g., create, read, update, delete)
  	user_id (identifier of the user who performed the action)
 	patient_id (identifier of the patient whose medical record the action was performed on)
   	type (high-level category of the event)
    	subtype (more granular description about the event)
   	object (human-readable name of what specifically was accessed)
    	object_changes (attributes and values that were added, updated, or removed on the object)
  	care_provider_id (identifier of the care provider associated with the event)
- searches: 
          search_1
how_to_implement:
search_1: 
- title: 
- description: 
- search: tag=auditevent tag=medicalrecord earliest=-30d
          | fields _time, user_id, patient, work_unit_ID
          | bin _time span=1h
          | stats dc(patient) as dc_patient by _time, user_id, work_unit_ID
          | eventstats perc95(dc_patient) as perc95_dc_patient by work_unit_ID
          | where _time > relative_time(_time, "-1h")
          | where dc_patient > perc95_dc_patient  
- earliest_time: Leave empty (defined in search via earliest option).
- latest_time: Leave empty (defined in search via latest option).
- cron schedule: * * * * *

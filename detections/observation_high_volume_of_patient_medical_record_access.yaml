name: High Volume of Unique Patient Medical Record Access
type: Observation Triggering
description: This detections looks for staff members that access a high volume of distinct patient medical journals in 
          a short time period compared to their peers. For each match, an observation is created and stored as an event in 
          index=observation_collection.
detection_ID: obs6
author: Simon Pettersson, Splunk
prerequisites:
- data sources:
          EHR audit events from any source
- tags: 
          auditevent (=identifies all EHR audit logs, regardless of source system)
- indexes: 
          observation_collection (=where identified observations are stored as individual events)
- fields: 
          staff_ID
          work_unit_ID
          care_provider_ID
          patient_ID
- searches: 
          search_1
how_to_implement:
search_1: 
- title: 
- description: 
- search: tag=auditevent staff_ID=* patient_ID=* earliest=-30d
          | fields _time, staff_ID, patient_ID, work_unit_ID
          | bin _time span=1h
          | stats dc(patient_ID) as dc_patient_ID by _time, staff_ID, work_unit_ID
          | eventstats perc95(dc_patient_ID) as perc95_dc_patient_ID by work_unit_ID
          | where _time > relative_time(_time, "-1h")
          | where dc_patient_ID > perc95_dc_patient_ID  
- earliest_time: Leave empty (defined in search via earliest option).
- latest_time: Leave empty (defined in search via latest option).
- cron schedule: * * * * *

name: High Volume of UniquePatient Medical Record Access
type: Observation Triggering
description: This detections looks for staff members that access a high volume of distinct patient medical journals in 
          a short time period. For each match, an observation is created and stored as an event in 
          index=observation_collection.
detection_ID: obs6
author: Simon Pettersson, Splunk
prerequisites:
- data sources:
          EMR audit logs
- tags: 
          emraudit
- indexes: 
          observation_collection (=where identified observations are stored as individual events)
- fields: 
          staff_ID
          patient_ID
- searches: 
          search_1
          search_2
how_to_implement:
search_1: 
- title: 
- description: 
- search: tag=emraudit staff_ID=* patient_ID=* earliest=-30d
          | fields _time, staff_ID, patient_ID
          | eventstats 
          | eval hourOfDay = strptime(_time, "%H")
          | rare hourOfDay by staff_ID
          | fields staff_ID, hourOfDay, percent
          | outputlookup baseline_access_hours
- earliest_time: Leave empty (defined in search via earliest option).
- latest_time: Leave empty (defined in search via latest option).
- cron schedule: * * * * *

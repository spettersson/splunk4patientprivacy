name: Baseline - First Seen Access
id: b04be6e5-2002-4349-8742-52333635b8f5
version: 1
author: Simon Pettersson, Splunk
type: Baseline
status: experimental
description: This search incrementally updates the history of what staff member has accessed what patient medical 
          record, and when, on a daily basis. 
data_source:
search: 
          tag=auditevent tag=patientrecord
          | fields _time, user_id, patient_id
          | stats latest(_time) as last_access by user_id, patient_id
          | inputlookup append=true baseline_historical_access
          | stats max(last_access) as last_access by user_id, patient_id
          | fields user_id, patient_id, last_access
          | outputlookup baseline_historical_access
scheduling:
  cron_schedule: '15 0 * * *'
  earliest_time: -1d@d
  latest_time: @d
how_to_implement: Before enabling this search, first run the search included in '1_baseline_backfill_first_seen_access.yaml' to get the full 6 month history.


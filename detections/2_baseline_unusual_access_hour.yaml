name: Baseline - Unusual Access Hours
id: b04be6e5-2002-4349-8742-52335635u8f5
version: 1
author: Simon Pettersson, Splunk
type: Baseline
status: experimental
description: This search creates and maintains a baseline of access hours to patient medical records for each staff member. 
          It identifies the least common hours by user and stores the results in a lookup table (baseline_access_hours), which subsequently
          utilized in the detection '2_detect_unusual_access_hours'.
search: tag=auditevent tag=patientrecord earliest=-30d
          | fields _time, user_id
          | eval hourOfDay = strftime(_time, "%H")
          | rare hourOfDay by user_id
          | fields user_id, hourOfDay, percent
          | outputlookup baseline_access_hours
how_to_implement: 

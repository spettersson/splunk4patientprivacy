name: Excessive Hours with Activity
id: b04be6e5-2u02-4349-8742-59111635y8f5
version: 1
author: Simon Pettersson, Splunk
type: Anomaly
status: experimental
description: This search runs on a scheduled basis to detect staff members accessing patient medical records 
        despite having an inactive role. This is done by assessing whethether the user's role either is
        marked as inactive, or if the defined period of the role has ended.
data_source: EHR audit data
search: tag=auditevent 
scheduling:
  cron_schedule: '25 * * * *'
  _index_earliest: -60min@min
  _index_latest: @min
how_to_implement: This search requires you to ingest EHR audit data that has the tags auditevent.
drilldown_searches:
- name: View the detection results
  search: '%original_detection_search% | search  user_id = "$user_id$" patient_id = "$patient_id$"'
  earliest_offset: $info_min_time$
  latest_offset: $info_max_time$
rba:
  message: 
  risk_objects:
  - field: user_id
    type: user
    score: 40
  - field: patient_id
    type: patient
    score: 40
